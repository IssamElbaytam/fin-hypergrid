"use strict";!function(){function e(e,i){i=i||{};var o=i.CellRenderer;if(!o||"string"==typeof o){var n=o||e.behavior.getActiveColumn(0).getCellProperty(0,"renderer"),a=e.cellRenderers.get(n);o=Object.getPrototypeOf(a).constructor}var l=o.extend(c,h),d=e.cellRenderers.add(l);Object.getOwnPropertyNames(i).forEach(function(e){d[e]=i[e]}),e.behavior.setHeaders=t,e.behavior.isColumnReorderable=r,e.behavior.dataModel.groupHeaderDelimiter=d.delimiter}function t(e){var t=Object.getPrototypeOf(this).setHeaders,r=this.grid.cellRenderers.get(c),i=r.delimiter;t.call(this,e);var o=this.columns.reduce(function(e,t){return Math.max(t.header.split(i).length,e)},0),n=this.grid.behavior.subgrids.header,a=4*o/3*this.grid.properties.defaultRowHeight;this.grid.setRowHeight(0,a,n),this.columns.forEach(function(e){e.setCellProperty(0,"renderer",c,n)})}function r(){var e=Object.getPrototypeOf(this).isColumnReorderable,t=e.call(this),r=this.grid.cellRenderers.get(c),i=r.delimiter;return t&&!this.columns.find(function(e){return e.getCellProperty(0,"renderer")===c&&e.header.indexOf(i)!==-1})}function i(e,t){function r(e){e in t&&(e in c.configStash?t[e]=c.configStash[e]:c.configStash[e]=t[e]);var r=c.config[e];"paintBackground"!==e&&"function"==typeof r&&(r=r.apply(this,a)),c[e]=r}function i(e){t[e]=c[e]}function o(e){t[e]=c.configStash[e]}var n=this["super"].paint,a=arguments,l=t.value.split(this.delimiter),d=l.length-1;if(0!==d&&0!==t.x||(this.groups=[]),d){var c,h=this.groups,u=t.bounds,f=u.x,g=u.width;u.height/=l.length;for(var p=0,y=u.y;p<d;p++,y+=u.height){if(h[p]&&l[p]===h[p].value?(c=h[p],c.width+=t.lineWidth+g):(c=h[p]=h[p]||{},c.value=l[p],c.left=f,c.width=g,c.configStash={isColumnHovered:t.isColumnHovered,isSelected:t.isSelected,font:t.font,backgroundColor:t.backgroundColor},c.config=this.groupConfig[p%this.groupConfig.length],Object.keys(c.config).forEach(r)),u.x=c.left,u.y=y,u.width=c.width,Object.keys(c.config).forEach(i),e.fillStyle=t.backgroundColor,e.fillRect(u.x,u.y,u.width,u.height),c.value){this.groupIndex=p,this.groupCount=d;var v=t.paintBackground||this.paintBackground;if(v){if("function"!=typeof v&&(v=s[v],"function"!=typeof v))throw"Expected decorator function of name of registered decorator function.";v.apply(this,arguments)}t.isColumnHovered=t.isSelected=!1,t.value=c.value,t.font="bold "+t.font,t.backgroundColor="transparent",n.apply(this,arguments)}Object.keys(c.configStash).forEach(o)}u.x=f,u.y=y,u.width=g,t.value=l[p]}n.apply(this,arguments)}function o(e,t){var r=t.bounds,i=e.createLinearGradient(r.x,r.y,r.x,r.y+r.height);(t.gradientStops||this.gradientStops).forEach(function(e){i.addColorStop.apply(i,e)}),e.fillStyle=i,e.fillRect(r.x+2,r.y,r.width-3,r.height)}function n(e,t){var r=t.bounds,i=t.thickness||this.groupCount-this.groupIndex;e.beginPath(),e.strokeStyle=t.color,e.lineWidth=i,e.moveTo(r.x+3,r.y+r.height-i),e.lineTo(r.x+r.width-2,r.y+r.height-i),e.stroke(),e.closePath()}function a(e,t,r,i){var o,n,a,s,c=e.fillStyle;return e.fillStyle=t,t=e.fillStyle,e.fillStyle=c,t=t.match(u),s=t[8],s?(o=parseInt(t[5],10),n=parseInt(t[6],10),a=parseInt(t[7],10)):(o=parseInt(t[2],16),n=parseInt(t[3],16),a=parseInt(t[4],16)),o=l(o,r),n=l(n,r),a=l(a,r),void 0!==i&&(s=i),void 0!==s?"rgba("+o+", "+n+", "+a+", "+s+")":"#"+d(o)+d(n)+d(a)}function l(e,t){return e+(255-e)*t}function d(e){var t=Math.round(e).toString(16);return e<16&&(t="0"+t),t}var s,c="GroupedHeader",h={paint:i,delimiter:"|",paintBackground:n,groupConfig:[{color:function(e,t){return a(e,t.color,.5)},gradientStops:function(e,t){return[[0,a(e,t.color,.5,0)],[1,a(e,t.color,.5,.35)]]}}]},u=/(^#([0-9a-f]{2,2})([0-9a-f]{2,2})([0-9a-f]{2,2})|rgba\((\d+),\s*(\d+),\s*(\d+),\s*([.\d]+)\))$/i;s={mixInTo:e,install:e,decorateBackgroundWithBottomBorder:n,decorateBackgroundWithLinearGradient:o,lighterColor:a},window.fin.Hypergrid.groupedHeader=s}();